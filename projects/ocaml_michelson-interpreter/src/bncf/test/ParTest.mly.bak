/* This ocamlyacc file was machine-generated by the BNF converter */
%{
open AbsTest
open Lexing

%}

%token KW_PUSH KW_DROP KW_int

%token SYMB1 /* ; */

%token TOK_EOF
%token <string> TOK_Ident
%token <char> TOK_Char
%token <float> TOK_Double
%token <int> TOK_Integer
%token <string> TOK_String
%token <string> TOK_Int
%token <string> TOK_Nat

%start pProg
%type <AbsTest.prog> pProg


%%
pProg : prog TOK_EOF { $1 }
  | error { raise (BNFC_Util.Parse_error (Parsing.symbol_start_pos (), Parsing.symbol_end_pos ())) };


prog : instr SYMB1 instr_list { Code ($1, $3) }
;

instr_list : /* empty */ { []  }
  | instr { (fun x -> [x]) $1 }
  | instr SYMB1 instr_list { (fun (x,xs) -> x::xs) ($1, $3) }
;

instr : instr SYMB1 {  $1 }
  | KW_PUSH cType data { IPUSH ($2, $3) }
  | KW_DROP { IADD  }
;

data : int { DInt $1 }
;

cType : KW_int { CInt  }
;


int : TOK_Int { Int ($1)};
nat : TOK_Nat { Nat ($1)};


